!function(s){function t(t){"null"!=s.cookie("YourTest")&&s.cookie("YourTest")||s.cookie("YourTest",JSON.stringify({currentQuestion:0,attempts:t}))}function e(t){s.cookie("YourTest",JSON.stringify(t))}function n(s){this.name="Your Test Exeption: ",this.message=s}function i(s,t){if(s)throw new n(t)}function a(e,n){this.test=e,this.questions,this.settings=s.extend({pathToQuestions:null,questionTextClassName:"test__questionText",progressBarClassName:"test__progress",warningClassName:"test__warning",answerOptionsClassName:"test__answerOption",answerClassName:"answerOption__answer",checkClassName:"answer__check",jumpButtonClassName:"test__jump-btn",progressBarText:null,warningText:"Выберите несколько вариантов ответов",jumpButtonText:"Получить ответ",saveLastUserQuestion:!0,numberOfAttempts:-1,answerNotFaithful:function(){alert("Не верный ответ")},testFailed:function(){alert("Тест провален"),location.reload()},testFinished:function(){alert("Тест окончен"),location.reload()}},n),t(this.settings.numberOfAttempts),this.settings.saveLastUserQuestion||(s.cookie("YourTest",null),t(this.settings.numberOfAttempts)),this.cookie=JSON.parse(s.cookie("YourTest")),this.checked=0}a.prototype.init=async function(){try{this.checkSettings()}catch(s){return void(null!=s.name&&null!=s.message&&console.error(s.name,s.message))}try{this.questions=await this.checksQuestions()}catch(s){return void(null!=s.name&&null!=s.message&&console.error(s.name,s.message))}this.createQuestion(this.questions[this.cookie.currentQuestion],this.questions.length)},a.prototype.checkSettings=function(){i(null==this.settings.pathToQuestions,"Путь до файла с вопросами небыл указан"),i(".json"!=this.settings.pathToQuestions.substr(this.settings.pathToQuestions.lastIndexOf(".")),"Файл с ответами толжен иметь расширение 'json'"),i("boolean"!=typeof this.settings.saveLastUserQuestion,"Поле saveLastUserQuestion должно иметь тип bolean"),i("number"!=typeof this.settings.numberOfAttempts,"Поле numberOfAttempts должно иметь тип number"),i(0==this.settings.numberOfAttempts,"numberOfAttempts не должно быть нулем")},a.prototype.checksQuestions=async function(){var t=await s.getJSON(this.settings.pathToQuestions);t=t;for(var e=0;e<t.length;e++){i(null==t[e].oneAnswer,"Вопрос №"+Number(e+1)+" - не найдено поле 'oneAnswer' или ему не задано значение."),i(1!=t[e].oneAnswer&&0!=t[e].oneAnswer,"Поле 'oneAnswer' ответа №"+Number(a+1)+" на вопрос №"+Number(e+1)+" должно являться булевым значением"),i(null==t[e].question,"Вопрос №"+Number(e+1)+" - не найдено поле 'question' или ему не задано значение."),i(t[e].question.length<=0||"string"!=typeof t[e].question,"Вопрос №"+Number(e+1)+" - поле 'question' пустой или же не является строкой"),i(null==t[e].answers,"Вопрос №"+Number(e+1)+" - не найдено поле 'answers' или ему не задано значение."),i(t[e].answers.length<=1||!Array.isArray(t[e].answers),"Вопрос №"+Number(e+1)+" - поле 'answers' содержит меньше 2х ответов или же не является массивом");for(var n=0,a=0;a<t[e].answers.length;a++)i(null==t[e].answers[a].text,"Поле 'text' ответа №"+Number(a+1)+" на вопрос №"+Number(e+1)+" не найдено или ему не задано значение"),i(t[e].answers[a].text.length<=0,"Поле 'text' ответа №"+Number(a+1)+" на вопрос №"+Number(e+1)+" пустое"),i(null==t[e].answers[a].rigth,"Поле 'rigth' ответа №"+Number(a+1)+" на вопрос №"+Number(e+1)+" не найдено или ему не задано значение"),i(1!=t[e].answers[a].rigth&&0!=t[e].answers[a].rigth,"Поле 'rigth' ответа №"+Number(a+1)+" на вопрос №"+Number(e+1)+" должно являться булевым значением"),t[e].answers[a].rigth&&n++;i(0==n,"В вопросе №"+Number(e+1)+" нет ни одного правильного ответа"),i(1==t[e].oneAnswer&&n>1,"В попросе №"+Number(e+1)+" больше 1 правильного ответа, хотя он помечен как вопрос с одним ответом"),i(0==t[e].oneAnswer&&1==n,"В попросе №"+Number(e+1)+" только 1 ответ, хотя он помечен как вопрос с несколькими вариантами ответов")}return t},a.prototype.createQuestion=function(t){this.test.append('<h2 class="'+this.settings.questionTextClassName+'">'+t.question+"</h2>"),null==this.settings.progressBarText?this.test.append('<div class="'+this.settings.progressBarClassName+'">Вопрос '+Number(this.cookie.currentQuestion+1)+" из "+this.questions.length+"</div>"):this.test.append('<div class="'+this.settings.progressBarClassName+'">'+this.settings.progressBarText+"</div>"),t.oneAnswer||this.test.append('<p class="'+this.settings.warningClassName+'">'+this.settings.warningText+"</p>"),this.test.append('<ul class="'+this.settings.answerOptionsClassName+' "></ul>');for(var n=0;n<t.answers.length;n++)t.oneAnswer?s("."+this.settings.answerOptionsClassName).append('<li class="'+this.settings.answerClassName+'"><input type="radio" name="yourTest" class="'+this.settings.checkClassName+'"><span>'+t.answers[n].text+"</span></li>"):s("."+this.settings.answerOptionsClassName).append('<li class="'+this.settings.answerClassName+'"><input type="checkbox" class="'+this.settings.checkClassName+'"><span>'+t.answers[n].text+"</span></li>");this.test.append('<button class="'+this.settings.jumpButtonClassName+'">'+this.settings.jumpButtonText+"</button>"),s("."+this.settings.jumpButtonClassName).attr("disabled","disabled");var i=this;i.test.find("."+i.settings.answerOptionsClassName+" span").click((function(){var t,e;t=i,s(e=this).siblings("."+t.settings.checkClassName).prop("checked")&&"radio"!=s(e).siblings("."+t.settings.checkClassName).attr("type")?(s(e).siblings("."+t.settings.checkClassName).prop("checked",!1),t.checked--,0==t.checked&&s("."+t.settings.jumpButtonClassName).attr("disabled","disable")):"radio"!=s(e).siblings("."+t.settings.checkClassName).attr("type")?(s(e).siblings("."+t.settings.checkClassName).prop("checked",!0),t.checked++,s("."+t.settings.jumpButtonClassName).attr("disabled",null)):(s(e).siblings("."+t.settings.checkClassName).prop("checked",!0),s("."+t.settings.jumpButtonClassName).attr("disabled",null))})).css("cursor","pointer"),i.test.find("."+i.settings.checkClassName).click((function(){!function(t,e){if(s(e).prop("checked")||"radio"==s(e).attr("type")){if("radio"!=s(e).attr("type"))return s(e).prop("checked",!0),t.checked++,void s("."+t.settings.jumpButtonClassName).attr("disabled",null);s("."+t.settings.jumpButtonClassName).attr("disabled",null)}else s(e).prop("checked",!1),t.checked--,0==t.checked&&s("."+t.settings.jumpButtonClassName).attr("disabled","disable")}(i,this)})).css("cursor","pointer"),i.test.find("."+i.settings.jumpButtonClassName).click((function(){!function(t,n){var i=!0;s("."+t.settings.answerOptionsClassName+" ."+t.settings.answerClassName+" ."+t.settings.checkClassName).each((function(t,e){s(e).prop("checked")==n.answers[t].rigth||(i=!1)})),i?(t.cookie.currentQuestion++,t.cookie.currentQuestion==t.questions.length?(t.cookie=null,e(t.cookie),t.settings.testFinished()):(e(t.cookie),t.test.html(""),t.createQuestion(t.questions[t.cookie.currentQuestion]))):(t.cookie.attempts--,0==t.cookie.attempts?(t.cookie=null,e(t.cookie),t.settings.testFailed()):(e(t.cookie),t.settings.answerNotFaithful()))}(i,t)}))},s.fn.yourTest=function(s){return new a(this.first(),s).init(),this.first()}}(jQuery);